<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>RegisterView.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;CloudBookClient&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">hmi.content.register</a> &gt; <span class="el_source">RegisterView.java</span></div><h1>RegisterView.java</h1><pre class="source lang-java linenums">package hmi.content.register;

import hmi.Launcher;
import hmi.content.AbstractActivity;
import hmi.content.Activity;
import hmi.home.MainView;
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.StandardCopyOption;
import javafx.beans.property.ObjectProperty;
import javafx.beans.property.SimpleObjectProperty;
import javafx.beans.property.StringProperty;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.control.Button;
import javafx.scene.control.Dialogs;
import model.node.Cloud;
import model.node.MyNode;
import model.node.NodeBuilder;

/**
 * View letting the user register an application
 */
public class RegisterView extends Activity {
    
    //vertical box containing all the identificator components
    protected SettingsArea settings;
    
    //ok button
    protected Button ok;
    
    //constructing object
    protected NodeBuilder builder;
    
    //File containing the logo of the application
    private final ObjectProperty&lt;File&gt; imageFile;

    /**
     * Getter
     * @return builder field
     */
    public NodeBuilder getBuilder() {
<span class="nc" id="L46">        return builder;</span>
    }

    /**
     * Setter
     * @param builder builder field
     */
    public void setBuilder(NodeBuilder builder) {
<span class="nc" id="L54">        this.builder = builder;</span>
<span class="nc" id="L55">    }</span>
    
    /**
     * initialize the vertical box
     * @param p previous Activity
     */
    public RegisterView(AbstractActivity p) {
<span class="nc" id="L62">        super(p);</span>
<span class="nc" id="L63">        imageFile = new SimpleObjectProperty&lt;&gt;();</span>
<span class="nc" id="L64">        title = &quot;Register your application&quot;;</span>
<span class="nc" id="L65">        settings = new SettingsArea();</span>
<span class="nc" id="L66">        setBottom(getOk());</span>
<span class="nc" id="L67">        setCenter(settings);</span>
<span class="nc" id="L68">    }</span>
    
    /**
     * Getter
     * @return ok field
     */
    public final Button getOk() {
<span class="nc bnc" id="L75" title="All 2 branches missed.">            if(ok == null) {</span>
<span class="nc" id="L76">                ok = new Button(&quot;Ok&quot;);</span>
<span class="nc" id="L77">                setAlignment(ok, Pos.CENTER);</span>
<span class="nc" id="L78">                setMargin(ok, new Insets(0, 0, 20, 0));</span>
<span class="nc" id="L79">                ok.setOnAction(new EventHandler&lt;ActionEvent&gt;() {</span>

                    @Override
                    public void handle(ActionEvent t) {
                        try {
<span class="nc" id="L84">                            File logo = settings.getIconArea().imageFileProperty().get();</span>
<span class="nc" id="L85">                            File target = new File(&quot;./res/&quot; + logo.getName());</span>
<span class="nc" id="L86">                            Files.copy(logo.toPath(), target.toPath(), StandardCopyOption.REPLACE_EXISTING);</span>
<span class="nc" id="L87">                            imageFile.set(target);</span>
<span class="nc" id="L88">                            MyNode node = builder.build();</span>
<span class="nc" id="L89">                            node.save();</span>
<span class="nc" id="L90">                            Dialogs.showInformationDialog(Launcher.STAGE, &quot;Success build&quot;, &quot;OK&quot;);</span>
<span class="nc" id="L91">                            MainView.INSTANCE.launch();</span>
<span class="nc" id="L92">                        } catch (IOException | ClassNotFoundException ex) {</span>
<span class="nc" id="L93">                            ex.printStackTrace();</span>
<span class="nc" id="L94">                            Dialogs.showErrorDialog(Launcher.STAGE, &quot;Error while building&quot;, &quot;Error&quot;);</span>
<span class="nc" id="L95">                        }</span>
<span class="nc" id="L96">                    }</span>
                    
                });
            }
<span class="nc" id="L100">            return ok;</span>
        }

    /**
     * Getter
     * @return settings field
     */
    public SettingsArea getSettings() {
<span class="nc" id="L108">        return settings;</span>
    }
    
    public ObjectProperty&lt;File&gt; imageFileProperty() {
<span class="nc" id="L112">        return imageFile;</span>
    }
    
    public StringProperty nameProperty() {
<span class="nc" id="L116">        return settings.getFieldArea().getName().getHint().textProperty();</span>
    }
    
    public StringProperty nodePortProperty() {
<span class="nc" id="L120">        return settings.getFieldArea().getNodePort().getHint().textProperty();</span>
    }
    
    public ObjectProperty&lt;Cloud&gt; cloudProperty() {
<span class="nc" id="L124">        return settings.clouds.valueProperty();</span>
    }
    
    public StringProperty appTypeProperty() {
<span class="nc" id="L128">        return settings.getFieldArea().getAppType().getHint().textProperty();</span>
    }
    
    public StringProperty PerfromanceProperty() {
<span class="nc" id="L132">        return settings.getFieldArea().getPerformance().getHint().textProperty();</span>
    }
    
    public StringProperty SpeedProperty() {
<span class="nc" id="L136">        return settings.getFieldArea().getSpeed().getHint().textProperty();</span>
    }
    
 }
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.1.201405082137</span></div></body></html>